[
  {
    "StmtText": "-- Hash Join\r\nSELECT\r\n    p.performance_id,\r\n    AVG(\r\n        (r.interpretation_score + r.sound_lighting_score + r.stage_presence_score + r.organization_score) / 4.0\r\n    ) AS avg_rating_by_visitor\r\nFROM Ticket t\r\nJOIN Event e ON t.event_id = e.event_id\r\nJOIN Performance p ON p.event_id = e.event_id\r\nLEFT JOIN Rating r ON r.performance_id = p.performance_id AND r.visitor_id = t.visitor_id\r\nWHERE t.visitor_id = 1\r\nGROUP BY p.performance_id\r\nOPTION (HASH JOIN);",
    "StmtId": 1,
    "NodeId": 1,
    "Parent": 0,
    "PhysicalOp": null,
    "LogicalOp": null,
    "Argument": "1",
    "DefinedValues": null,
    "EstimateRows": 4.060606,
    "EstimateIO": null,
    "EstimateCPU": null,
    "AvgRowSize": null,
    "TotalSubtreeCost": 0.060169138,
    "OutputList": null,
    "Warnings": null,
    "Type": "SELECT",
    "Parallel": "0",
    "EstimateExecutions": null
  },
  {
    "StmtText": "  |--Compute Scalar(DEFINE:([Expr1004]=CASE WHEN [Expr1006]=(0) THEN NULL ELSE [Expr1007]/CONVERT_IMPLICIT(numeric(19,0),[Expr1006],0) END))",
    "StmtId": 1,
    "NodeId": 2,
    "Parent": 1,
    "PhysicalOp": "Compute Scalar",
    "LogicalOp": "Compute Scalar",
    "Argument": "DEFINE:([Expr1004]=CASE WHEN [Expr1006]=(0) THEN NULL ELSE [Expr1007]/CONVERT_IMPLICIT(numeric(19,0),[Expr1006],0) END)",
    "DefinedValues": "[Expr1004]=CASE WHEN [Expr1006]=(0) THEN NULL ELSE [Expr1007]/CONVERT_IMPLICIT(numeric(19,0),[Expr1006],0) END",
    "EstimateRows": 4.060606,
    "EstimateIO": 0.0,
    "EstimateCPU": 0.0,
    "AvgRowSize": 28,
    "TotalSubtreeCost": 0.060169138,
    "OutputList": "[p].[performance_id], [Expr1004]",
    "Warnings": null,
    "Type": "PLAN_ROW",
    "Parallel": "0",
    "EstimateExecutions": 1.0
  },
  {
    "StmtText": "       |--Stream Aggregate(GROUP BY:([p].[performance_id]) DEFINE:([Expr1006]=COUNT_BIG([Expr1005]), [Expr1007]=SUM([Expr1005])))",
    "StmtId": 1,
    "NodeId": 3,
    "Parent": 2,
    "PhysicalOp": "Stream Aggregate",
    "LogicalOp": "Aggregate",
    "Argument": "GROUP BY:([p].[performance_id])",
    "DefinedValues": "[Expr1006]=COUNT_BIG([Expr1005]), [Expr1007]=SUM([Expr1005])",
    "EstimateRows": 4.060606,
    "EstimateIO": 0.0,
    "EstimateCPU": 6.0963637E-05,
    "AvgRowSize": 28,
    "TotalSubtreeCost": 0.060169138,
    "OutputList": "[p].[performance_id], [Expr1006], [Expr1007]",
    "Warnings": null,
    "Type": "PLAN_ROW",
    "Parallel": "0",
    "EstimateExecutions": 1.0
  },
  {
    "StmtText": "            |--Sort(ORDER BY:([p].[performance_id] ASC))",
    "StmtId": 1,
    "NodeId": 4,
    "Parent": 3,
    "PhysicalOp": "Sort",
    "LogicalOp": "Sort",
    "Argument": "ORDER BY:([p].[performance_id] ASC)",
    "DefinedValues": null,
    "EstimateRows": 98.22222,
    "EstimateIO": 0.011261261,
    "EstimateCPU": 0.0011140706,
    "AvgRowSize": 20,
    "TotalSubtreeCost": 0.060108174,
    "OutputList": "[p].[performance_id], [Expr1005]",
    "Warnings": null,
    "Type": "PLAN_ROW",
    "Parallel": "0",
    "EstimateExecutions": 1.0
  },
  {
    "StmtText": "                 |--Compute Scalar(DEFINE:([Expr1005]=CONVERT_IMPLICIT(numeric(10,0),[DbNtua2025v2].[dbo].[Rating].[interpretation_score] as [r].[interpretation_score]+[DbNtua2025v2].[dbo].[Rating].[sound_lighting_score] as [r].[sound_lighting_score]+[DbNtua2025v2].[dbo].[Rating].[stage_presence_score] as [r].[stage_presence_score]+[DbNtua2025v2].[dbo].[Rating].[organization_score] as [r].[organization_score],0)/(4.0)))",
    "StmtId": 1,
    "NodeId": 5,
    "Parent": 4,
    "PhysicalOp": "Compute Scalar",
    "LogicalOp": "Compute Scalar",
    "Argument": "DEFINE:([Expr1005]=CONVERT_IMPLICIT(numeric(10,0),[DbNtua2025v2].[dbo].[Rating].[interpretation_score] as [r].[interpretation_score]+[DbNtua2025v2].[dbo].[Rating].[sound_lighting_score] as [r].[sound_lighting_score]+[DbNtua2025v2].[dbo].[Rating].[stage_presence_score] as [r].[stage_presence_score]+[DbNtua2025v2].[dbo].[Rating].[organization_score] as [r].[organization_score],0)/(4.0))",
    "DefinedValues": "[Expr1005]=CONVERT_IMPLICIT(numeric(10,0),[DbNtua2025v2].[dbo].[Rating].[interpretation_score] as [r].[interpretation_score]+[DbNtua2025v2].[dbo].[Rating].[sound_lighting_score] as [r].[sound_lighting_score]+[DbNtua2025v2].[dbo].[Rating].[stage_presence_score] as [r].[stage_presence_score]+[DbNtua2025v2].[dbo].[Rating].[organization_score] as [r].[organization_score],0)/(4.0)",
    "EstimateRows": 98.22222,
    "EstimateIO": 0.0,
    "EstimateCPU": 9.822223E-06,
    "AvgRowSize": 20,
    "TotalSubtreeCost": 0.04773284,
    "OutputList": "[p].[performance_id], [Expr1005]",
    "Warnings": null,
    "Type": "PLAN_ROW",
    "Parallel": "0",
    "EstimateExecutions": 1.0
  },
  {
    "StmtText": "                      |--Hash Match(Right Outer Join, HASH:([r].[performance_id])=([p].[performance_id]))",
    "StmtId": 1,
    "NodeId": 6,
    "Parent": 5,
    "PhysicalOp": "Hash Match",
    "LogicalOp": "Right Outer Join",
    "Argument": "HASH:([r].[performance_id])=([p].[performance_id])",
    "DefinedValues": null,
    "EstimateRows": 98.22222,
    "EstimateIO": 0.0,
    "EstimateCPU": 0.018300008,
    "AvgRowSize": 27,
    "TotalSubtreeCost": 0.04772302,
    "OutputList": "[p].[performance_id], [r].[interpretation_score], [r].[sound_lighting_score], [r].[stage_presence_score], [r].[organization_score]",
    "Warnings": null,
    "Type": "PLAN_ROW",
    "Parallel": "0",
    "EstimateExecutions": 1.0
  },
  {
    "StmtText": "                           |--Clustered Index Scan(OBJECT:([DbNtua2025v2].[dbo].[Rating].[PK__Rating__D35B278BED352814] AS [r]), WHERE:([DbNtua2025v2].[dbo].[Rating].[visitor_id] as [r].[visitor_id]=(1)))",
    "StmtId": 1,
    "NodeId": 7,
    "Parent": 6,
    "PhysicalOp": "Clustered Index Scan",
    "LogicalOp": "Clustered Index Scan",
    "Argument": "OBJECT:([DbNtua2025v2].[dbo].[Rating].[PK__Rating__D35B278BED352814] AS [r]), WHERE:([DbNtua2025v2].[dbo].[Rating].[visitor_id] as [r].[visitor_id]=(1))",
    "DefinedValues": "[r].[performance_id], [r].[interpretation_score], [r].[sound_lighting_score], [r].[stage_presence_score], [r].[organization_score]",
    "EstimateRows": 1.0,
    "EstimateIO": 0.003125,
    "EstimateCPU": 0.000212,
    "AvgRowSize": 31,
    "TotalSubtreeCost": 0.003337,
    "OutputList": "[r].[performance_id], [r].[interpretation_score], [r].[sound_lighting_score], [r].[stage_presence_score], [r].[organization_score]",
    "Warnings": null,
    "Type": "PLAN_ROW",
    "Parallel": "0",
    "EstimateExecutions": 1.0
  },
  {
    "StmtText": "                           |--Hash Match(Inner Join, HASH:([t].[event_id])=([p].[event_id]))",
    "StmtId": 1,
    "NodeId": 8,
    "Parent": 6,
    "PhysicalOp": "Hash Match",
    "LogicalOp": "Inner Join",
    "Argument": "HASH:([t].[event_id])=([p].[event_id])",
    "DefinedValues": null,
    "EstimateRows": 100.0,
    "EstimateIO": 0.0,
    "EstimateCPU": 0.018323692,
    "AvgRowSize": 11,
    "TotalSubtreeCost": 0.026059011,
    "OutputList": "[p].[performance_id]",
    "Warnings": null,
    "Type": "PLAN_ROW",
    "Parallel": "0",
    "EstimateExecutions": 1.0
  },
  {
    "StmtText": "                                |--Index Scan(OBJECT:([DbNtua2025v2].[dbo].[Ticket].[unique_ticket_per_visitor_event] AS [t]),  WHERE:([DbNtua2025v2].[dbo].[Ticket].[visitor_id] as [t].[visitor_id]=(1)))",
    "StmtId": 1,
    "NodeId": 9,
    "Parent": 8,
    "PhysicalOp": "Index Scan",
    "LogicalOp": "Index Scan",
    "Argument": "OBJECT:([DbNtua2025v2].[dbo].[Ticket].[unique_ticket_per_visitor_event] AS [t]),  WHERE:([DbNtua2025v2].[dbo].[Ticket].[visitor_id] as [t].[visitor_id]=(1))",
    "DefinedValues": "[t].[event_id]",
    "EstimateRows": 4.060606,
    "EstimateIO": 0.0038657407,
    "EstimateCPU": 0.0003781,
    "AvgRowSize": 15,
    "TotalSubtreeCost": 0.004243841,
    "OutputList": "[t].[event_id]",
    "Warnings": null,
    "Type": "PLAN_ROW",
    "Parallel": "0",
    "EstimateExecutions": 1.0
  },
  {
    "StmtText": "                                |--Index Scan(OBJECT:([DbNtua2025v2].[dbo].[Performance].[idx_performance_event_id] AS [p]))",
    "StmtId": 1,
    "NodeId": 10,
    "Parent": 8,
    "PhysicalOp": "Index Scan",
    "LogicalOp": "Index Scan",
    "Argument": "OBJECT:([DbNtua2025v2].[dbo].[Performance].[idx_performance_event_id] AS [p])",
    "DefinedValues": "[p].[performance_id], [p].[event_id]",
    "EstimateRows": 100.0,
    "EstimateIO": 0.003125,
    "EstimateCPU": 0.000267,
    "AvgRowSize": 15,
    "TotalSubtreeCost": 0.003392,
    "OutputList": "[p].[performance_id], [p].[event_id]",
    "Warnings": "NO STATS:([Performance].[event_id])",
    "Type": "PLAN_ROW",
    "Parallel": "0",
    "EstimateExecutions": 1.0
  }
]