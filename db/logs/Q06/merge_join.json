[
  {
    "StmtText": "-- Merge Join\r\nSELECT\r\n    p.performance_id,\r\n    AVG(\r\n        (r.interpretation_score + r.sound_lighting_score + r.stage_presence_score + r.organization_score) / 4.0\r\n    ) AS avg_rating_by_visitor\r\nFROM Ticket t\r\nJOIN Event e ON t.event_id = e.event_id\r\nJOIN Performance p ON p.event_id = e.event_id\r\nLEFT JOIN Rating r ON r.performance_id = p.performance_id AND r.visitor_id = t.visitor_id\r\nWHERE t.visitor_id = 1\r\nGROUP BY p.performance_id\r\nOPTION (MERGE JOIN);",
    "StmtId": 1,
    "NodeId": 1,
    "Parent": 0,
    "PhysicalOp": null,
    "LogicalOp": null,
    "Argument": "1",
    "DefinedValues": null,
    "EstimateRows": 4.060606,
    "EstimateIO": null,
    "EstimateCPU": null,
    "AvgRowSize": null,
    "TotalSubtreeCost": 0.03829765,
    "OutputList": null,
    "Warnings": null,
    "Type": "SELECT",
    "Parallel": "0",
    "EstimateExecutions": null
  },
  {
    "StmtText": "  |--Compute Scalar(DEFINE:([Expr1004]=CASE WHEN [Expr1010]=(0) THEN NULL ELSE [Expr1011]/CONVERT_IMPLICIT(numeric(19,0),[Expr1010],0) END))",
    "StmtId": 1,
    "NodeId": 2,
    "Parent": 1,
    "PhysicalOp": "Compute Scalar",
    "LogicalOp": "Compute Scalar",
    "Argument": "DEFINE:([Expr1004]=CASE WHEN [Expr1010]=(0) THEN NULL ELSE [Expr1011]/CONVERT_IMPLICIT(numeric(19,0),[Expr1010],0) END)",
    "DefinedValues": "[Expr1004]=CASE WHEN [Expr1010]=(0) THEN NULL ELSE [Expr1011]/CONVERT_IMPLICIT(numeric(19,0),[Expr1010],0) END",
    "EstimateRows": 4.060606,
    "EstimateIO": 0.0,
    "EstimateCPU": 0.0,
    "AvgRowSize": 28,
    "TotalSubtreeCost": 0.03829765,
    "OutputList": "[p].[performance_id], [Expr1004]",
    "Warnings": null,
    "Type": "PLAN_ROW",
    "Parallel": "0",
    "EstimateExecutions": 1.0
  },
  {
    "StmtText": "       |--Stream Aggregate(GROUP BY:([p].[performance_id]) DEFINE:([Expr1010]=COUNT_BIG([Expr1005]), [Expr1011]=SUM([Expr1005])))",
    "StmtId": 1,
    "NodeId": 3,
    "Parent": 2,
    "PhysicalOp": "Stream Aggregate",
    "LogicalOp": "Aggregate",
    "Argument": "GROUP BY:([p].[performance_id])",
    "DefinedValues": "[Expr1010]=COUNT_BIG([Expr1005]), [Expr1011]=SUM([Expr1005])",
    "EstimateRows": 4.060606,
    "EstimateIO": 0.0,
    "EstimateCPU": 6.0963637E-05,
    "AvgRowSize": 28,
    "TotalSubtreeCost": 0.03829765,
    "OutputList": "[p].[performance_id], [Expr1010], [Expr1011]",
    "Warnings": null,
    "Type": "PLAN_ROW",
    "Parallel": "0",
    "EstimateExecutions": 1.0
  },
  {
    "StmtText": "            |--Compute Scalar(DEFINE:([Expr1005]=CONVERT_IMPLICIT(numeric(10,0),[DbNtua2025v2].[dbo].[Rating].[interpretation_score] as [r].[interpretation_score]+[DbNtua2025v2].[dbo].[Rating].[sound_lighting_score] as [r].[sound_lighting_score]+[DbNtua2025v2].[dbo].[Rating].[stage_presence_score] as [r].[stage_presence_score]+[DbNtua2025v2].[dbo].[Rating].[organization_score] as [r].[organization_score],0)/(4.0)))",
    "StmtId": 1,
    "NodeId": 4,
    "Parent": 3,
    "PhysicalOp": "Compute Scalar",
    "LogicalOp": "Compute Scalar",
    "Argument": "DEFINE:([Expr1005]=CONVERT_IMPLICIT(numeric(10,0),[DbNtua2025v2].[dbo].[Rating].[interpretation_score] as [r].[interpretation_score]+[DbNtua2025v2].[dbo].[Rating].[sound_lighting_score] as [r].[sound_lighting_score]+[DbNtua2025v2].[dbo].[Rating].[stage_presence_score] as [r].[stage_presence_score]+[DbNtua2025v2].[dbo].[Rating].[organization_score] as [r].[organization_score],0)/(4.0))",
    "DefinedValues": "[Expr1005]=CONVERT_IMPLICIT(numeric(10,0),[DbNtua2025v2].[dbo].[Rating].[interpretation_score] as [r].[interpretation_score]+[DbNtua2025v2].[dbo].[Rating].[sound_lighting_score] as [r].[sound_lighting_score]+[DbNtua2025v2].[dbo].[Rating].[stage_presence_score] as [r].[stage_presence_score]+[DbNtua2025v2].[dbo].[Rating].[organization_score] as [r].[organization_score],0)/(4.0)",
    "EstimateRows": 98.22222,
    "EstimateIO": 0.0,
    "EstimateCPU": 9.822223E-06,
    "AvgRowSize": 20,
    "TotalSubtreeCost": 0.038236685,
    "OutputList": "[p].[performance_id], [Expr1005]",
    "Warnings": null,
    "Type": "PLAN_ROW",
    "Parallel": "0",
    "EstimateExecutions": 1.0
  },
  {
    "StmtText": "                 |--Merge Join(Left Outer Join, MERGE:([p].[performance_id])=([r].[performance_id]), RESIDUAL:([DbNtua2025v2].[dbo].[Rating].[performance_id] as [r].[performance_id]=[DbNtua2025v2].[dbo].[Performance].[performance_id] as [p].[performance_id]))",
    "StmtId": 1,
    "NodeId": 5,
    "Parent": 4,
    "PhysicalOp": "Merge Join",
    "LogicalOp": "Left Outer Join",
    "Argument": "MERGE:([p].[performance_id])=([r].[performance_id]), RESIDUAL:([DbNtua2025v2].[dbo].[Rating].[performance_id] as [r].[performance_id]=[DbNtua2025v2].[dbo].[Performance].[performance_id] as [p].[performance_id])",
    "DefinedValues": null,
    "EstimateRows": 98.22222,
    "EstimateIO": 0.0,
    "EstimateCPU": 0.0056140223,
    "AvgRowSize": 27,
    "TotalSubtreeCost": 0.038226865,
    "OutputList": "[p].[performance_id], [r].[interpretation_score], [r].[sound_lighting_score], [r].[stage_presence_score], [r].[organization_score]",
    "Warnings": null,
    "Type": "PLAN_ROW",
    "Parallel": "0",
    "EstimateExecutions": 1.0
  },
  {
    "StmtText": "                      |--Sort(ORDER BY:([p].[performance_id] ASC))",
    "StmtId": 1,
    "NodeId": 6,
    "Parent": 5,
    "PhysicalOp": "Sort",
    "LogicalOp": "Sort",
    "Argument": "ORDER BY:([p].[performance_id] ASC)",
    "DefinedValues": null,
    "EstimateRows": 100.0,
    "EstimateIO": 0.011261261,
    "EstimateCPU": 0.0011364525,
    "AvgRowSize": 11,
    "TotalSubtreeCost": 0.025961561,
    "OutputList": "[p].[performance_id]",
    "Warnings": null,
    "Type": "PLAN_ROW",
    "Parallel": "0",
    "EstimateExecutions": 1.0
  },
  {
    "StmtText": "                      |    |--Merge Join(Inner Join, MERGE:([t].[event_id])=([p].[event_id]), RESIDUAL:([DbNtua2025v2].[dbo].[Performance].[event_id] as [p].[event_id]=[DbNtua2025v2].[dbo].[Ticket].[event_id] as [t].[event_id]))",
    "StmtId": 1,
    "NodeId": 7,
    "Parent": 6,
    "PhysicalOp": "Merge Join",
    "LogicalOp": "Inner Join",
    "Argument": "MERGE:([t].[event_id])=([p].[event_id]), RESIDUAL:([DbNtua2025v2].[dbo].[Performance].[event_id] as [p].[event_id]=[DbNtua2025v2].[dbo].[Ticket].[event_id] as [t].[event_id])",
    "DefinedValues": null,
    "EstimateRows": 100.0,
    "EstimateIO": 0.0,
    "EstimateCPU": 0.0058285273,
    "AvgRowSize": 11,
    "TotalSubtreeCost": 0.013563848,
    "OutputList": "[p].[performance_id]",
    "Warnings": null,
    "Type": "PLAN_ROW",
    "Parallel": "0",
    "EstimateExecutions": 1.0
  },
  {
    "StmtText": "                      |         |--Index Scan(OBJECT:([DbNtua2025v2].[dbo].[Ticket].[unique_ticket_per_visitor_event] AS [t]),  WHERE:([DbNtua2025v2].[dbo].[Ticket].[visitor_id] as [t].[visitor_id]=(1)) ORDERED FORWARD)",
    "StmtId": 1,
    "NodeId": 8,
    "Parent": 7,
    "PhysicalOp": "Index Scan",
    "LogicalOp": "Index Scan",
    "Argument": "OBJECT:([DbNtua2025v2].[dbo].[Ticket].[unique_ticket_per_visitor_event] AS [t]),  WHERE:([DbNtua2025v2].[dbo].[Ticket].[visitor_id] as [t].[visitor_id]=(1)) ORDERED FORWARD",
    "DefinedValues": "[t].[event_id]",
    "EstimateRows": 4.060606,
    "EstimateIO": 0.0038657407,
    "EstimateCPU": 0.0003781,
    "AvgRowSize": 15,
    "TotalSubtreeCost": 0.004243841,
    "OutputList": "[t].[event_id]",
    "Warnings": null,
    "Type": "PLAN_ROW",
    "Parallel": "0",
    "EstimateExecutions": 1.0
  },
  {
    "StmtText": "                      |         |--Index Scan(OBJECT:([DbNtua2025v2].[dbo].[Performance].[idx_performance_event_id] AS [p]), ORDERED FORWARD)",
    "StmtId": 1,
    "NodeId": 9,
    "Parent": 7,
    "PhysicalOp": "Index Scan",
    "LogicalOp": "Index Scan",
    "Argument": "OBJECT:([DbNtua2025v2].[dbo].[Performance].[idx_performance_event_id] AS [p]), ORDERED FORWARD",
    "DefinedValues": "[p].[performance_id], [p].[event_id]",
    "EstimateRows": 100.0,
    "EstimateIO": 0.003125,
    "EstimateCPU": 0.000267,
    "AvgRowSize": 15,
    "TotalSubtreeCost": 0.003392,
    "OutputList": "[p].[performance_id], [p].[event_id]",
    "Warnings": "NO STATS:([Performance].[event_id])",
    "Type": "PLAN_ROW",
    "Parallel": "0",
    "EstimateExecutions": 1.0
  },
  {
    "StmtText": "                      |--Nested Loops(Inner Join, OUTER REFERENCES:([r].[rating_id]))",
    "StmtId": 1,
    "NodeId": 10,
    "Parent": 5,
    "PhysicalOp": "Nested Loops",
    "LogicalOp": "Inner Join",
    "Argument": "OUTER REFERENCES:([r].[rating_id])",
    "DefinedValues": null,
    "EstimateRows": 1.0,
    "EstimateIO": 0.0,
    "EstimateCPU": 4.18E-06,
    "AvgRowSize": 27,
    "TotalSubtreeCost": 0.00664828,
    "OutputList": "[r].[performance_id], [r].[interpretation_score], [r].[sound_lighting_score], [r].[stage_presence_score], [r].[organization_score]",
    "Warnings": null,
    "Type": "PLAN_ROW",
    "Parallel": "0",
    "EstimateExecutions": 1.0
  },
  {
    "StmtText": "                           |--Index Scan(OBJECT:([DbNtua2025v2].[dbo].[Rating].[idx_rating_performance_visitor] AS [r]),  WHERE:([DbNtua2025v2].[dbo].[Rating].[visitor_id] as [r].[visitor_id]=(1)) ORDERED FORWARD)",
    "StmtId": 1,
    "NodeId": 11,
    "Parent": 10,
    "PhysicalOp": "Index Scan",
    "LogicalOp": "Index Scan",
    "Argument": "OBJECT:([DbNtua2025v2].[dbo].[Rating].[idx_rating_performance_visitor] AS [r]),  WHERE:([DbNtua2025v2].[dbo].[Rating].[visitor_id] as [r].[visitor_id]=(1)) ORDERED FORWARD",
    "DefinedValues": "[r].[rating_id], [r].[performance_id], [r].[visitor_id]",
    "EstimateRows": 1.0,
    "EstimateIO": 0.003125,
    "EstimateCPU": 0.000212,
    "AvgRowSize": 19,
    "TotalSubtreeCost": 0.003337,
    "OutputList": "[r].[rating_id], [r].[performance_id], [r].[visitor_id]",
    "Warnings": null,
    "Type": "PLAN_ROW",
    "Parallel": "0",
    "EstimateExecutions": 1.0
  },
  {
    "StmtText": "                           |--Clustered Index Seek(OBJECT:([DbNtua2025v2].[dbo].[Rating].[PK__Rating__D35B278BED352814] AS [r]), SEEK:([r].[rating_id]=[DbNtua2025v2].[dbo].[Rating].[rating_id] as [r].[rating_id]) LOOKUP ORDERED FORWARD)",
    "StmtId": 1,
    "NodeId": 13,
    "Parent": 10,
    "PhysicalOp": "Clustered Index Seek",
    "LogicalOp": "Clustered Index Seek",
    "Argument": "OBJECT:([DbNtua2025v2].[dbo].[Rating].[PK__Rating__D35B278BED352814] AS [r]), SEEK:([r].[rating_id]=[DbNtua2025v2].[dbo].[Rating].[rating_id] as [r].[rating_id]) LOOKUP ORDERED FORWARD",
    "DefinedValues": "[r].[interpretation_score], [r].[sound_lighting_score], [r].[stage_presence_score], [r].[organization_score]",
    "EstimateRows": 1.0,
    "EstimateIO": 0.003125,
    "EstimateCPU": 0.0001581,
    "AvgRowSize": 23,
    "TotalSubtreeCost": 0.0032831,
    "OutputList": "[r].[interpretation_score], [r].[sound_lighting_score], [r].[stage_presence_score], [r].[organization_score]",
    "Warnings": null,
    "Type": "PLAN_ROW",
    "Parallel": "0",
    "EstimateExecutions": 1.0
  }
]